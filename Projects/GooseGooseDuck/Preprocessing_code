Use backslash for path

def Preprocessing_code(path_to_imgs):
    all_classes = {}
    imgs = []
    classes = []
    h,w = 299,299
    for i, name in enumerate(os.listdir(path_to_imgs)):
        all_classes[i] = name
        for j in tqdm(os.listdir(path_to_imgs + name)):
            img = cv2.imread(path_to_imgs + name + "/" + j)
            img = cv2.cvtColor(img,cv2.COLOR_BGR2RGB)
            img = cv2.resize(img,(h,w))
            imgs.append(tf.keras.applications.inception_v3.preprocess_input(img))
            classes.append(i)
    x = np.array(x)
    y = np.array(y)
    return all_classes, imgs, classes

Example of use

Preprocessing_code(path)

